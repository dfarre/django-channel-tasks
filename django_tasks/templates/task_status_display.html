<script>
    function replaceById(elementId, mutate) {
        const container = document.getElementById(elementId);
        if (container) {
            const content = container.innerHTML;
            container.innerHTML = mutate(content);
        } else {
            console.log('Element ' + elementId + ' not found.');
        }

    }

    var admin_ws = admin_ws || new WebSocket('ws://' + window.location.host + '/tasks/');

    admin_ws.onopen = function (event) {
        console.log('WebSocket connection opened at /tasks/.');
    };

    admin_ws.onclose = function (event) {
        console.log('WebSocket connection at /tasks/ closed.');
    };

    admin_ws.onerror = function (event) {
        console.error('WebSocket error at /tasks/:', event);
    };

    admin_ws.onmessage = function (msg_event) {
        console.log('WebSocket message received: ' + msg_event.data);
        const msg = JSON.parse(msg_event.data);
        const group = msg.type.split('.')[0];
        if (group == 'task') {
            location.reload();
        }
    }
</script>

{% extends "admin/change_list.html" %}
