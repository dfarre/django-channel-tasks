<script>
    var admin_ws = admin_ws || new WebSocket('ws://' + window.location.host + '/tasks/');

    admin_ws.onopen = function (event) {
        console.log('WebSocket connection opened at /tasks/');
    };

    admin_ws.onclose = function (event) {
        console.log('WebSocket connection at /tasks/ closed.');
    };

    admin_ws.onerror = function (event) {
        console.error('WebSocket error at /tasks/:', event);
    };

    admin_ws.onmessage = function (msg_event) {
        console.log('WebSocket received: ' + JSON.stringify(msg_event, ['type', 'data']));
        const msg = JSON.parse(msg_event.data);
        const group = msg.type.split('.')[0];
        if (group == 'task') {
            // location.reload();
            document.getElementById(`task-msg-{msg.content.pk}`).innerHTML = JSON.stringify(msg.content);
            // location.reload();
        }
    }
</script>
{% extends "admin/change_list.html" %}
